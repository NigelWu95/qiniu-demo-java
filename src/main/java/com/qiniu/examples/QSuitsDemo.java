package com.qiniu.examples;

import com.qiniu.datasource.IDataSource;
import com.qiniu.entry.CommonParams;
import com.qiniu.entry.QSuitsEntry;
import com.qiniu.interfaces.IEntryParam;
import com.qiniu.process.qoss.CopyFile;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class QSuitsDemo {

    static List<String> buckets = new ArrayList<String>(){{
        add("fhyfhy298");
//        add("fhyfhy498");
//        add("fhyfhy499");
//        add("fhyfhy500");
//        add("fhyfhy501");
//        add("fhyfhy502");
//        add("fhyfhy503");
//        add("fhyfhy504");
//        add("fhyfhy505");
//        add("fhyfhy506");
//        add("fhyfhy507");
//        add("fhyfhy508");
//        add("fhyfhy509");
//        add("fhyfhy510");
//        add("fhyfhy511");
//        add("fhyfhy512");
//        add("fhyfhy513");
//        add("fhyfhy514");
//        add("fhyfhy515");
//        add("fhyfhy516");
//        add("fhyfhy517");
//        add("fhyfhy518");
//        add("fhyfhy519");
//        add("fhyfhy520");
//        add("fhyfhy521");
//        add("fhyfhy522");
//        add("fhyfhy523");
//        add("fhyfhy524");
//        add("fhyfhy525");
//        add("fhyfhy526");
//        add("fhyfhy527");
//        add("fhyfhy528");
//        add("fhyfhy529");
//        add("fhyfhy530");
//        add("fhyfhy531");
//        add("fhyfhy532");
//        add("fhyfhy533");
//        add("fhyfhy534");
//        add("fhyfhy535");
//        add("fhyfhy536");
//        add("fhyfhy537");
//        add("fhyfhy539");
//        add("fhyfhy540");
//        add("fhyfhy541");
//        add("fhyfhy542");
//        add("fhyfhy543");
//        add("fhyfhy544");
//        add("fhyfhy545");
//        add("fhyfhy546");
//        add("fhyfhy547");
//        add("fhyfhy548");
//        add("fhyfhy549");
//        add("fhyfhy550");
//        add("fhyfhy551");
//        add("fhyfhy552");
//        add("fhyfhy553");
//        add("fhyfhy554");
//        add("fhyfhy555");
//        add("fhyfhy556");
//        add("fhyfhy557");
//        add("fhyfhy558");
//        add("fhyfhy559");
//        add("fhyfhy560");
//        add("fhyfhy561");
//        add("fhyfhy562");
//        add("fhyfhy563");
//        add("fhyfhy564");
//        add("fhyfhy565");
//        add("fhyfhy566");
//        add("fhyfhy567");
//        add("fhyfhy568");
//        add("fhyfhy569");
//        add("fhyfhy570");
//        add("fhyfhy571");
//        add("fhyfhy572");
//        add("fhyfhy573");
//        add("fhyfhy574");
//        add("fhyfhy575");
//        add("fhyfhy576");
//        add("fhyfhy577");
//        add("fhyfhy578");
//        add("fhyfhy579");
//        add("fhyfhy580");
//        add("fhyfhy581");
//        add("fhyfhy582");
//        add("fhyfhy583");
//        add("fhyfhy584");
//        add("fhyfhy585");
//        add("fhyfhy586");
//        add("fhyfhy587");
//        add("fhyfhy588");
//        add("fhyfhy589");
//        add("fhyfhy590");
//        add("fhyfhy591");
//        add("fhyfhy592");
//        add("fhyfhy593");
//        add("fhyfhy594");
//        add("fhyfhy595");
//        add("fhyfhy596");
//        add("fhyfhy597");
//        add("fhyfhy598");
//        add("fhyfhy599");
//        add("fhyfhy600");
//        add("fhyfhy538");
//        add("fhyfhy601");
//        add("fhyfhy602");
//        add("fhyfhy603");
//        add("fhyfhy604");
//        add("fhyfhy605");
//        add("fhyfhy607");
//        add("fhyfhy608");
//        add("fhyfhy609");
//        add("fhyfhy610");
//        add("fhyfhy611");
//        add("fhyfhy612");
//        add("fhyfhy613");
//        add("fhyfhy614");
//        add("fhyfhy615");
//        add("fhyfhy616");
//        add("fhyfhy617");
//        add("fhyfhy618");
//        add("fhyfhy619");
//        add("fhyfhy620");
//        add("fhyfhy621");
//        add("fhyfhy622");
//        add("fhyfhy623");
//        add("fhyfhy624");
//        add("fhyfhy625");
//        add("fhyfhy626");
//        add("fhyfhy627");
//        add("fhyfhy628");
//        add("fhyfhy629");
//        add("fhyfhy630");
//        add("fhyfhy631");
//        add("fhyfhy632");
//        add("fhyfhy633");
//        add("fhyfhy634");
//        add("fhyfhy635");
//        add("fhyfhy636");
//        add("fhyfhy637");
//        add("fhyfhy638");
//        add("fhyfhy639");
//        add("fhyfhy640");
//        add("fhyfhy641");
//        add("fhyfhy642");
//        add("fhyfhy643");
//        add("fhyfhy644");
//        add("fhyfhy645");
//        add("fhyfhy646");
//        add("fhyfhy647");
//        add("fhyfhy648");
//        add("fhyfhy649");
//        add("fhyfhy650");
//        add("fhyfhy651");
//        add("fhyfhy652");
//        add("fhyfhy653");
//        add("fhyfhy654");
//        add("fhyfhy655");
//        add("fhyfhy656");
//        add("fhyfhy657");
//        add("fhyfhy658");
//        add("fhyfhy659");
//        add("fhyfhy660");
//        add("fhyfhy661");
//        add("fhyfhy662");
//        add("fhyfhy663");
//        add("fhyfhy664");
//        add("fhyfhy665");
//        add("fhyfhy666");
//        add("fhyfhy667");
//        add("fhyfhy668");
//        add("fhyfhy669");
//        add("fhyfhy670");
//        add("fhyfhy671");
//        add("fhyfhy672");
//        add("fhyfhy673");
//        add("fhyfhy674");
//        add("fhyfhy675");
//        add("fhyfhy676");
//        add("fhyfhy677");
//        add("fhyfhy678");
//        add("fhyfhy679");
//        add("fhyfhy680");
//        add("fhyfhy681");
//        add("fhyfhy682");
//        add("fhyfhy683");
//        add("fhyfhy684");
//        add("fhyfhy685");
//        add("fhyfhy686");
//        add("fhyfhy687");
//        add("fhyfhy688");
//        add("fhyfhy689");
//        add("fhyfhy690");
//        add("fhyfhy691");
//        add("fhyfhy692");
//        add("fhyfhy693");
//        add("fhyfhy694");
//        add("fhyfhy695");
//        add("fhyfhy696");
//        add("fhyfhy697");
//        add("fhyfhy698");
//        add("fhyfhy699");
//        add("fhyfhy700");
//        add("fhyfhy606");
//        add("fhyfhy800");
//        add("fhyfhy801");
//        add("fhyfhy802");
//        add("fhyfhy803");
//        add("fhyfhy804");
//        add("fhyfhy805");
//        add("fhyfhy806");
//        add("fhyfhy807");
//        add("fhyfhy808");
//        add("fhyfhy809");
//        add("fhyfhy810");
//        add("fhyfhy811");
//        add("fhyfhy812");
//        add("fhyfhy813");
//        add("fhyfhy814");
//        add("fhyfhy815");
//        add("fhyfhy816");
//        add("fhyfhy817");
//        add("fhyfhy818");
//        add("fhyfhy819");
//        add("fhyfhy820");
//        add("fhyfhy821");
//        add("fhyfhy822");
//        add("fhyfhy823");
//        add("fhyfhy824");
//        add("fhyfhy825");
//        add("fhyfhy826");
//        add("fhyfhy827");
//        add("fhyfhy828");
//        add("fhyfhy829");
//        add("fhyfhy830");
//        add("fhcloudds");
//        add("fhyfhy831");
//        add("fhyfhy832");
//        add("fhyfhy833");
//        add("fhyfhy834");
//        add("fhyfhy835");
//        add("fhyfhy836");
//        add("fhyfhy837");
//        add("fhyfhy838");
//        add("fhyfhy839");
//        add("fhyfhy840");
//        add("fhyfhy841");
//        add("fhyfhy842");
//        add("fhyfhy843");
//        add("fhyfhy844");
//        add("fhyfhy845");
//        add("fhyfhy846");
//        add("fhyfhy847");
//        add("fhyfhy848");
//        add("fhyfhy849");
//        add("fhyfhy850");
//        add("fhyfhy851");
//        add("fhyfhy852");
//        add("fhyfhy853");
//        add("fhyfhy854");
//        add("fhyfhy855");
//        add("fhyfhy856");
//        add("fhyfhy857");
//        add("fhyfhy858");
//        add("fhyfhy859");
//        add("fhyfhy860");
//        add("fhyfhy861");
//        add("fhyfhy862");
//        add("fhyfhy863");
//        add("fhyfhy864");
//        add("fhyfhy865");
//        add("fhyfhy866");
//        add("fhyfhy867");
//        add("fhyfhy868");
//        add("fhyfhy869");
//        add("fhyfhy870");
//        add("fhyfhy871");
//        add("fhyfhy872");
//        add("fhyfhy873");
//        add("fhyfhy874");
//        add("fhyfhy875");
//        add("fhyfhy876");
//        add("fhyfhy877");
//        add("fhyfhy878");
//        add("fhyfhy880");
//        add("fhyfhy881");
//        add("fhyfhy882");
//        add("fhyfhy883");
//        add("fhyfhy884");
//        add("fhyfhy885");
//        add("fhyfhy886");
//        add("fhyfhy887");
//        add("fhyfhy888");
//        add("fhyfhy889");
//        add("fhyfhy890");
//        add("fhyfhy891");
//        add("fhyfhy892");
//        add("fhyfhy893");
//        add("fhyfhy894");
//        add("fhyfhy895");
//        add("fhyfhy896");
//        add("fhyfhy897");
//        add("fhyfhy898");
//        add("fhyfhy899");
//        add("fhyfhy900");
//        add("fhyfhy879");
//        add("fhyfhy901");
//        add("fhyfhy902");
//        add("fhyfhy903");
//        add("fhyfhy904");
//        add("fhyfhy905");
//        add("fhyfhy906");
//        add("fhyfhy907");
//        add("fhyfhy908");
//        add("fhyfhy909");
//        add("fhyfhy910");
//        add("fhyfhy911");
//        add("fhyfhy912");
//        add("fhyfhy913");
//        add("fhyfhy914");
//        add("fhyfhy915");
//        add("fhyfhy916");
//        add("fhyfhy917");
//        add("fhyfhy918");
//        add("fhyfhy919");
//        add("fhyfhy920");
//        add("fhyfhy921");
//        add("fhyfhy922");
//        add("fhyfhy923");
//        add("fhyfhy924");
//        add("fhyfhy925");
//        add("fhyfhy926");
//        add("fhyfhy927");
//        add("fhyfhy928");
//        add("fhyfhy929");
//        add("fhyfhy930");
//        add("fhyfhy931");
//        add("fhyfhy932");
//        add("fhyfhy933");
//        add("fhyfhy934");
//        add("fhyfhy935");
//        add("fhyfhy936");
//        add("fhyfhy937");
//        add("fhyfhy938");
//        add("fhyfhy939");
//        add("fhyfhy940");
//        add("fhyfhy941");
//        add("fhyfhy942");
//        add("fhyfhy943");
//        add("fhyfhy944");
//        add("fhyfhy945");
//        add("fhyfhy946");
//        add("fhyfhy947");
//        add("fhyfhy948");
//        add("fhyfhy949");
//        add("fhyfhy950");
//        add("fhyfhy951");
//        add("fhyfhy952");
//        add("fhyfhy953");
//        add("fhyfhy954");
//        add("fhyfhy955");
//        add("fhyfhy956");
//        add("fhyfhy957");
//        add("fhyfhy958");
//        add("fhyfhy959");
//        add("fhyfhy960");
//        add("fhyfhy961");
//        add("fhyfhy962");
//        add("fhyfhy963");
//        add("fhyfhy964");
//        add("fhyfhy965");
//        add("fhyfhy966");
//        add("fhyfhy967");
//        add("fhyfhy968");
//        add("fhyfhy969");
//        add("fhyfhy970");
//        add("fhyfhy971");
//        add("fhyfhy972");
//        add("fhyfhy973");
//        add("fhyfhy974");
//        add("fhyfhy975");
//        add("fhyfhy976");
//        add("fhyfhy977");
//        add("fhyfhy978");
//        add("fhyfhy979");
//        add("fhyfhy980");
//        add("fhyfhy981");
//        add("fhyfhy982");
//        add("fhyfhy983");
//        add("fhyfhy984");
//        add("fhyfhy985");
//        add("fhyfhy986");
//        add("fhyfhy987");
//        add("fhyfhy988");
//        add("fhyfhy989");
//        add("fhyfhy990");
//        add("fhyfhy991");
//        add("fhyfhy992");
//        add("fhyfhy993");
//        add("fhyfhy994");
//        add("fhyfhy995");
//        add("fhyfhy996");
//        add("fhyfhy997");
//        add("fhyfhy998");
//        add("fhyfhy999");
//        add("fhyfhy1000");
//        add("fhyfhy1001");
//        add("fhyfhy1002");
//        add("fhyfhy1003");
//        add("fhyfhy1004");
//        add("fhyfhy1005");
//        add("fhyfhy1006");
//        add("fhyfhy1007");
//        add("fhyfhy1008");
//        add("fhyfhy1009");
//        add("fhyfhy1010");
//        add("fhyfhy1011");
//        add("fhyfhy1012");
//        add("fhyfhy1013");
//        add("fhyfhy1014");
//        add("fhyfhy1015");
//        add("fhyfhy1016");
//        add("fhyfhy1017");
//        add("fhyfhy1018");
//        add("fhyfhy1019");
//        add("fhyfhy1020");
//        add("fhyfhy1021");
//        add("fhyfhy1022");
//        add("fhyfhy1023");
//        add("fhyfhy1024");
//        add("fhyfhy1025");
//        add("fhyfhy1026");
//        add("fhyfhy1027");
//        add("fhyfhy1028");
//        add("fhyfhy1029");
//        add("fhyfhy1030");
//        add("fhyfhy1031");
//        add("fhyfhy1032");
//        add("fhyfhy1033");
//        add("fhyfhy1034");
//        add("fhyfhy1035");
//        add("fhyfhy1036");
//        add("fhyfhy1037");
//        add("fhyfhy1038");
//        add("fhyfhy1039");
//        add("fhyfhy1040");
//        add("fhyfhy1041");
//        add("fhyfhy1042");
//        add("fhyfhy1043");
//        add("fhyfhy1044");
//        add("fhyfhy1045");
//        add("fhyfhy1046");
//        add("fhyfhy1047");
//        add("fhyfhy1048");
//        add("fhyfhy1049");
//        add("fhyfhy1050");
//        add("fhyfhy1051");
//        add("fhyfhy1052");
//        add("fhyfhy1053");
//        add("fhyfhy1054");
//        add("fhyfhy1055");
//        add("fhyfhy1056");
//        add("fhyfhy1057");
//        add("fhyfhy1058");
//        add("fhyfhy1059");
//        add("fhyfhy1060");
//        add("fhyfhy1061");
//        add("fhyfhy1062");
//        add("fhyfhy1063");
//        add("fhyfhy1064");
//        add("fhyfhy1065");
//        add("fhyfhy1066");
//        add("fhyfhy1067");
//        add("fhyfhy1068");
//        add("fhyfhy1069");
//        add("fhyfhy1070");
//        add("fhyfhy1071");
//        add("fhyfhy1072");
//        add("fhyfhy1073");
//        add("fhyfhy1074");
//        add("fhyfhy1075");
//        add("fhyfhy1076");
//        add("fhyfhy1077");
//        add("fhyfhy1078");
//        add("fhyfhy1079");
//        add("fhyfhy1080");
//        add("fhyfhy1081");
//        add("fhyfhy1082");
//        add("fhyfhy1083");
//        add("fhyfhy1084");
//        add("fhyfhy1085");
//        add("fhyfhy1086");
//        add("fhyfhy1087");
//        add("fhyfhy1088");
//        add("fhyfhy1089");
//        add("fhyfhy1090");
//        add("fhyfhy1091");
//        add("fhyfhy1092");
//        add("fhyfhy1093");
//        add("fhyfhy1094");
//        add("fhyfhy1095");
//        add("fhyfhy1096");
//        add("fhyfhy1097");
//        add("fhyfhy1098");
//        add("fhyfhy1099");
//        add("fhyfhy1100");
//        add("fhyfhy1101");
//        add("fhyfhy1102");
//        add("fhyfhy1103");
//        add("fhyfhy1104");
//        add("fhyfhy1105");
//        add("fhyfhy1106");
//        add("fhyfhy1107");
//        add("fhyfhy1108");
//        add("fhyfhy1109");
//        add("fhyfhy1110");
//        add("fhyfhy1111");
//        add("fhyfhy1112");
//        add("fhyfhy1113");
//        add("fhyfhy1114");
//        add("fhyfhy1115");
//        add("fhyfhy1116");
//        add("fhyfhy1117");
//        add("fhyfhy1118");
//        add("fhyfhy1119");
//        add("fhyfhy1120");
//        add("fhyfhy1121");
//        add("fhyfhy1122");
//        add("fhyfhy1123");
//        add("fhyfhy1124");
//        add("fhyfhy1125");
//        add("fhyfhy1126");
//        add("fhyfhy1127");
//        add("fhyfhy1128");
//        add("fhyfhy1129");
//        add("fhyfhy1130");
//        add("fhyfhy1131");
//        add("fhyfhy1132");
//        add("fhyfhy1133");
//        add("fhyfhy1134");
//        add("fhyfhy1135");
//        add("fhyfhy1136");
//        add("fhyfhy1137");
//        add("fhyfhy1138");
//        add("fhyfhy1139");
//        add("fhyfhy1140");
//        add("fhyfhy1141");
//        add("fhyfhy1142");
//        add("fhyfhy1143");
//        add("fhyfhy1144");
//        add("fhyfhy1145");
//        add("fhyfhy1146");
//        add("fhyfhy1147");
//        add("fhyfhy1148");
//        add("fhyfhy1149");
//        add("fhyfhy1150");
//        add("fhyfhy1151");
//        add("fhyfhy1152");
//        add("fhyfhy1153");
//        add("fhyfhy1154");
//        add("fhyfhy1155");
//        add("fhyfhy1156");
//        add("fhyfhy1157");
//        add("fhyfhy1158");
//        add("fhyfhy1159");
//        add("fhyfhy1160");
//        add("fhyfhy1161");
//        add("fhyfhy1162");
//        add("fhyfhy1163");
//        add("fhyfhy1164");
//        add("fhyfhy1165");
//        add("fhyfhy1166");
//        add("fhyfhy1167");
//        add("fhyfhy1168");
//        add("fhyfhy1169");
//        add("fhyfhy1170");
//        add("fhyfhy1171");
//        add("fhyfhy1172");
//        add("fhyfhy1173");
//        add("fhyfhy1174");
//        add("fhyfhy1175");
//        add("fhyfhy1176");
//        add("fhyfhy1177");
//        add("fhyfhy1178");
//        add("fhyfhy1179");
//        add("fhyfhy1180");
//        add("fhyfhy1181");
//        add("fhyfhy1182");
//        add("fhyfhy1183");
//        add("fhyfhy1184");
//        add("fhyfhy1185");
//        add("fhyfhy1186");
//        add("fhyfhy1187");
//        add("fhyfhy1188");
//        add("fhyfhy1189");
//        add("fhyfhy1190");
//        add("fhyfhy1191");
//        add("fhyfhy1192");
//        add("fhyfhy1193");
//        add("fhyfhy1194");
//        add("fhyfhy1196");
//        add("fhyfhy1195");
//        add("fhyfhy1197");
//        add("fhyfhy1198");
//        add("fhyfhy1199");
//        add("fhyfhy1200");
    }};

    public static void main(String[] args) throws Exception {
        QSuitsEntry qSuitsEntry = new QSuitsEntry(args);
        IEntryParam entryParam = qSuitsEntry.getEntryParam();
        Map<String, String> paramsMap = entryParam.getParamsMap();
        String savePath = paramsMap.get("save-path");
        CommonParams commonParams = qSuitsEntry.getCommonParams();
        CopyFile processor = (CopyFile) qSuitsEntry.getProcessor();
        IDataSource dataSource = qSuitsEntry.getDataSource();
        boolean saveTotal = commonParams.getSaveTotal();
        String saveFormat = commonParams.getSaveFormat();
        String saveSeparator = commonParams.getSaveSeparator();
        List<String> rmFields = commonParams.getRmFields();

        // 不断去更改 bucket 做执行
        for (String bucket : buckets) {
            commonParams.setBucket(bucket + "-src");
            commonParams.setSavePath(savePath + "/" + bucket);
            if (processor != null) {
                processor.updateCopy(bucket + "-src", bucket, null, null, null);
                processor.updateSavePath(savePath + "/" + bucket);
            }
            if (dataSource != null) {
                dataSource.setSaveOptions(saveTotal, saveFormat, saveSeparator, rmFields);
                dataSource.updateSettings(commonParams);
                dataSource.setProcessor(processor);
                dataSource.export();
            }
        }

        if (processor != null) processor.closeResource();
    }
}
